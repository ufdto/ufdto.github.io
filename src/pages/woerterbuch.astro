---
import BaseLayout from "../layouts/BaseLayout.astro";

export const chronik = {
  title: "Egerländer Wörterbuch",
  subtitle: "Wörter aus der Erinnerung",
  date: "2026-01-12",
  bereich: "Texte, Stimmen und Erinnerungen",
  href: "/woerterbuch",
  order: 1,
};

const intro =
  "Dieses Wörterbuch ist kein wissenschaftliches Nachschlagewerk, sondern ein sprachliches Erinnerungsdokument: aus dem gelebten Sprachgefühl heraus gesammelt und notiert. Es bewahrt Wortformen, Klangnähe und Bedeutungsanklänge – so, wie sie im Alltag präsent waren. Gerade weil nicht alles eindeutig ist, bleibt der Charakter der Quelle sichtbar.";

const note =
  "Das Dokument wird hier bewusst unverändert gezeigt. Ergänzungen, Vereinheitlichungen oder „Verbesserungen“ würden den Quellencharakter verändern. Es handelt sich um ein privates Wörterbuch aus dem Nachlass von Erich Heinzl, zusammengestellt von ihm selbst und weitergegeben durch seinen Sohn Andreas Heinzl. Der Umfang beträgt 36 Seiten";

const pdfUrl = "/data/egerlaender-woerterbuch.pdf";

/* Gedicht als Bild (schön gesetzt) */
const poemTitle = "Da Drrrn";
const poemImageUrl = "/data/da-drrrn.jpg";
const poemHint =
  "Hinweis: Klicke auf das Gedicht, um Abschnitt für Abschnitt eine sinngemäße Zeile-für-Zeile-Begleitung zu öffnen.";

/* Popup-Inhalte: Dialekt UNVERÄNDERT, darunter sinngetreu */
const poemSections = [
  {
    dialekt: [
      "S Bejwl woa nuu recht kloa(n,",
      "Koa Mänsch denkt, dasma dåu scho(n Ra(d)lfåhrn koa(n,",
      "San Bodvadda owa håut dåu ånnascht denkt",
      "Uu håut nan z’Weihnåchtn a Fåhrr(a)d’l gschenkt.",
    ],
    deutung: [
      "Der Bub war noch sehr klein.",
      "Niemand glaubt, dass man in diesem Alter schon Fahrrad fahren kann.",
      "Sein Taufpate sieht das anders.",
      "Zu Weihnachten schenkt er ihm ein kleines Fahrrad.",
    ],
  },
  {
    dialekt: [
      "S’ Ra(d)l woa råut uu d’ Gråiß håut påßt,",
      "S’ håut an Freilauf ghått, uu s’ Bremsen wåa aa koa Låst.",
      "S’ Fåhrnlerna woa füas Bejwl aa recht leicht,",
      "A Bißl am Såttl haltn håut schon greicht.",
    ],
    deutung: [
      "Das Fahrrad war rot, und die Größe hat genau gepasst.",
      "Es hatte einen Freilauf, und das Bremsen bereitete keine Schwierigkeiten.",
      "Das Fahrradfahren zu lernen fiel dem Buben recht leicht.",
      "Ein wenig Festhalten am Sattel genügte bereits.",
    ],
  },
  {
    dialekt: [
      "Sua long da Voda dees håut denkt,",
      "S’ Bejwl scho(n aloin in da Stråuß oi lenkt.",
      "A Motoa füas Ra(d)l waa holt aa nu schäjn,",
      "Waals owa neat san koa, mouß Drrn, Drrrn va sölwa gåjhn.",
    ],
    deutung: [
      "Während der Vater noch darüber nachdenkt,",
      "fährt der Bub mit dem Fahrrad schon allein die Straße hinunter.",
      "Ein Motor für das Fahrrad wäre natürlich auch noch schön gewesen.",
      "Weil es aber keinen gibt, muss das „Drrrn, Drrrn“ von ihm selbst kommen.",
    ],
  },
  {
    dialekt: [
      "S’ Peppal startet s’ Ra(d)l wej an Motoa,",
      "Waal ma ba dean Ra(d)la zruckwårts tre(t)n koa.",
      "Drrrn, drrrn schnurrt ea ban Drehgasge(b)m,",
      "Denn suaran Start håust mejn mietdale(b)m.",
    ],
    deutung: [
      "Der Bub startet das Fahrrad so, als wäre es ein Motorrad.",
      "Denn bei diesem Fahrrad kann man rückwärts in die Pedale treten.",
      "Dabei macht er selbst das Motorgeräusch und dreht mit der Hand am imaginären Gasgriff.",
      "So einen Start hast du selbst miterleben müssen.",
    ],
  },
  {
    dialekt: [
      "Båal drrrnt ea durchs Dorf uu ims Haus,",
      "Füa d’ Nåchbern woa dees a rechta Graus.",
      "Unna olwara Harras håut dåzou nu baalt,",
      "håut afs Bejwl gwårt, is voa da Loontüa ghaalt.",
    ],
    deutung: [
      "Bald fährt er mit seinem „Drrrn-drrrn“ durchs Dorf und rund ums Haus.",
      "Für die Nachbarn ist das wirklich nervig, ein rechter Graus.",
      "Und der alberne, verrückte Schäferhund Harras bellt dazu auch noch laut mit.",
      "Er wartet vor der Ladentür auf den Buben und bellt weiter.",
    ],
  },
  {
    dialekt: [
      "Leit gets assn Wech, da Wickn Drrrn kinnt,",
      "Waal s’ Bejwl uu dea Huund koa Rücksicht nimmt.",
      "Wickn Drrrn hoo neat ii dafunna,",
      "Af dean Nåuma san Dorfleit va sölwa kumma.",
    ],
    deutung: [
      "Die Leute rufen, man solle aus dem Weg gehen, der Wickn Drrrn kommt.",
      "Denn der Bub und der Hund nehmen auf niemanden Rücksicht.",
      "Den Namen habe nicht ich erfunden,",
      "sondern die Leute im Dorf sind selbst auf diesen Namen gekommen.",
    ],
  },
  {
    dialekt: [
      "Waa s’ Pepperl neat gwaxn, waa dahoim ea bliem,",
      "Nu heint täjtm(a)n häjan, mietn Drrn håut-a-se Zeit vatriem.",
      "Sechzich Gåua san seit dåmåls vagonga,",
      "Owa oan dej Drrrnzeit håuta quies oft nuu s’ Valonga.",
    ],
    deutung: [
      "Wenn der Bub nicht gewachsen wäre und daheim geblieben wäre,",
      "würde man ihn wohl heute noch hören, wie er sich mit dem „Drrrn“ die Zeit vertreibt.",
      "Sechzig Jahre sind seit damals vergangen,",
      "aber nach dieser Drrrn-Zeit hat man noch immer Sehnsucht.",
    ],
  },
];

const transitionTitle = "Eine Geschichte in Mundart";
const transitionText =
  "Wörter stehen selten für sich allein. Sie leben im Erzählen – in Situationen, in Bewegung, in kleinen Begebenheiten.\n\nDas folgende Gedicht zeigt genau das: eine kurze Dorfgeschichte, humorvoll und sehr lebendig erzählt. Auch wenn man nicht jede Zeile sofort versteht, trägt die Handlung von selbst.\n\nWer genauer hinsehen möchte, kann sich den Text Abschnitt für Abschnitt erschließen.";
---

<BaseLayout title={chronik.title}>
  <article class="text-ort">
    <header class="head">
      <h1>{chronik.title}</h1>
      <p class="subtitle">{chronik.subtitle}</p>

      <p class="intro">{intro}</p>
      <p class="note">{note}</p>
    </header>

    <section class="content" lang="de" aria-label="PDF: Egerländer Wörterbuch">
      <figure class="pdf">
        <div class="pdf-frame" role="group" aria-label="PDF-Viewer">
          <object class="pdf-object" data={pdfUrl} type="application/pdf">
            <div class="pdf-fallback" role="note">
              <p>
                Dein Browser kann das PDF hier leider nicht direkt anzeigen.
              </p>
              <p class="links">
                <a href={pdfUrl} target="_blank" rel="noopener"
                  >PDF in neuem Tab öffnen</a
                >
                <span class="dot">·</span>
                <a href={pdfUrl} download>PDF herunterladen</a>
              </p>
            </div>
          </object>
        </div>
      </figure>

      <div class="credit" aria-label="Hinweise zur Quelle">
        <p>
          Hinweis: Die Schreibweisen folgen dem persönlichen Sprachgefühl und
          der Erinnerung an die gesprochene Mundart. Mehrdeutigkeiten (z. B. bei
          Lautnähe) sind Teil des Dokuments.
        </p>
        <p class="links">
          <a href={pdfUrl} target="_blank" rel="noopener">PDF öffnen</a>
          <span class="dot">·</span>
          <a href={pdfUrl} download>Download</a>
        </p>
      </div>
    </section>

    <!-- Übergang + Gedicht -->
    <section class="poem-wrap" lang="de" aria-label="Gedicht: Da Drrrn">
      <h2 class="poem-h2">{transitionTitle}</h2>

      {
        transitionText
          .split("\n\n")
          .map((para) => <p class="poem-transition">{para}</p>)
      }

      <figure class="poem-figure">
        <div
          class="poem-click"
          role="button"
          tabindex="0"
          aria-haspopup="dialog"
          aria-controls="poem-dialog"
          aria-label="Gedicht anklicken, um eine Abschnitt-für-Abschnitt Begleitung zu öffnen"
          data-poem-open
        >
          <img
            class="poem-img"
            src={poemImageUrl}
            alt={`Gedicht: ${poemTitle}`}
            loading="lazy"
          />
        </div>
      </figure>

      <p class="poem-hint">{poemHint}</p>
    </section>

    <!-- Dialog / Popup -->
    <dialog id="poem-dialog" class="dialog" aria-label="Begleitung zum Gedicht">
      <div class="dialog-inner" role="document">
        <header class="dialog-head">
          <div class="dialog-title">
            <div class="dialog-h">{poemTitle}</div>
          </div>

          <button
            class="dialog-close"
            type="button"
            aria-label="Schließen"
            data-poem-close
          >
            schließen
          </button>
        </header>

        <div class="dialog-body">
          {
            poemSections.map((sec, idx) => (
              <section class="panel" data-panel hidden={idx !== 0}>
                <div class="panel-meta">
                  Abschnitt <strong>{idx + 1}</strong> von{" "}
                  <strong>{poemSections.length}</strong>
                </div>

                <div
                  class="lines"
                  aria-label="Dialektzeilen und Bedeutungszeilen"
                >
                  {sec.dialekt.map((line, i) => (
                    <div class="pair">
                      <div class="dialekt">{line}</div>
                      <div class="deutung">→ {sec.deutung[i]}</div>
                    </div>
                  ))}
                </div>
              </section>
            ))
          }
        </div>

        <footer class="dialog-foot">
          <button type="button" class="nav-link" data-poem-prev>
            zurück
          </button>
          <span class="nav-sep">·</span>
          <button type="button" class="nav-link" data-poem-next>
            weiter
          </button>
        </footer>
      </div>
    </dialog>
  </article>
</BaseLayout>

<script is:inline>
  (() => {
    const openEl = document.querySelector("[data-poem-open]");
    const dlg = document.getElementById("poem-dialog");
    if (!openEl || !dlg || typeof dlg.showModal !== "function") return;

    const panels = Array.from(dlg.querySelectorAll("[data-panel]"));
    const btnPrev = dlg.querySelector("[data-poem-prev]");
    const btnNext = dlg.querySelector("[data-poem-next]");
    const closeBtns = dlg.querySelectorAll("[data-poem-close]");

    let idx = 0;

    const sync = () => {
      panels.forEach((p, i) => (p.hidden = i !== idx));
      if (btnPrev) btnPrev.disabled = idx === 0;
      if (btnNext) btnNext.disabled = idx === panels.length - 1;
    };

    const open = () => {
      idx = 0;
      sync();
      dlg.showModal();
      // focus: close button (always available)
      const closeBtn = dlg.querySelector("[data-poem-close]");
      closeBtn?.focus();
    };

    const close = () => {
      try {
        dlg.close();
      } catch {}
      openEl.focus();
    };

    openEl.addEventListener("click", open);
    openEl.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        open();
      }
    });

    closeBtns.forEach((b) => b.addEventListener("click", close));

    btnPrev?.addEventListener("click", () => {
      if (idx > 0) {
        idx -= 1;
        sync();
      }
    });

    btnNext?.addEventListener("click", () => {
      if (idx < panels.length - 1) {
        idx += 1;
        sync();
      }
    });

    // Backdrop click closes
    dlg.addEventListener("click", (e) => {
      const rect = dlg.getBoundingClientRect();
      const inDialog =
        e.clientX >= rect.left &&
        e.clientX <= rect.right &&
        e.clientY >= rect.top &&
        e.clientY <= rect.bottom;
      if (!inDialog) close();
    });

    // Keyboard navigation
    dlg.addEventListener("keydown", (e) => {
      if (e.key === "Escape") return; // native close
      if (e.key === "ArrowLeft") {
        if (idx > 0) {
          idx -= 1;
          sync();
        }
      }
      if (e.key === "ArrowRight") {
        if (idx < panels.length - 1) {
          idx += 1;
          sync();
        }
      }
    });

    dlg.addEventListener("close", () => {
      openEl.focus();
    });
  })();
</script>

<style>
  /* ===== Grundlayout ===== */
  .text-ort {
    width: min(860px, 100%);
    margin-left: 0;
    margin-right: auto;
  }

  /* ===== Kopf ===== */
  .head {
    margin-bottom: 1.6rem;
  }

  .subtitle {
    margin: -0.35rem 0 0.9rem 0;
    font-size: 1.15rem;
    line-height: 1.35;
    color: rgba(0, 0, 0, 0.72);
  }

  /* ===== Kopf (ruhiger, wie auf den anderen Seiten) ===== */
  .head {
    margin-bottom: 1.6rem;
  }

  /* Titel + Untertitel als Einheit */
  .head h1 {
    margin: 0 0 0.35rem 0;
  }

  .subtitle {
    margin: 0 0 1.15rem 0; /* mehr Luft vor der Einleitung */
    font-size: 1.15rem;
    line-height: 1.35;
    color: rgba(0, 0, 0, 0.78); /* etwas dunkler: näher am Haupttext */
  }

  /* ===== Kopf (ruhiger, wie auf den anderen Seiten) ===== */
  .head {
    margin-bottom: 1.6rem;
  }

  /* ===== Kopf (ruhiger Rhythmus: Titel+Untertitel als Einheit, klare Zäsur zur Einleitung) ===== */
  .head {
    margin-bottom: 1.6rem;
  }

  /* Titel: keine zusätzliche Luft nach oben, nur eine kleine nach unten */
  .head h1 {
    margin: 0 0 0.18rem 0; /* enger: Untertitel näher an den Titel */
  }

  /* Untertitel: klar als zweite Ebene erkennbar + danach deutliche Zäsur */
  .subtitle {
    margin: 0 0 1.35rem 0; /* mehr Abstand zur Einleitung */
    font-size: 1.15rem;
    line-height: 1.35;
    color: rgba(
      0,
      0,
      0,
      0.68
    ); /* sichtbar grau (sekundär), nicht “fast schwarz” */
  }

  /* Einleitung = Haupttext */
  .intro,
  .note {
    margin: 0 0 0.9rem 0;
    font-size: 1rem;
    line-height: 1.65;
    color: rgba(0, 0, 0, 0.9); /* klarer Haupttext */
  }

  /* Zweiter Absatz darf minimal zurücktreten, bleibt aber Haupttext */
  .note {
    color: rgba(0, 0, 0, 0.84);
    margin-bottom: 0;
  }

  /* der zweite Absatz darf minimal zurücktreten, bleibt aber Haupttext */
  .note {
    color: rgba(0, 0, 0, 0.84);
    margin-bottom: 0;
  }

  /* ===== Content ===== */
  .content {
    margin-top: 1.2rem;
  }

  /* ===== PDF ===== */
  figure.pdf {
    margin: 0;
  }

  /* ===== PDF: Buch-/Archiv-Anmutung ===== */
  .pdf-frame {
    width: 100%;
    border-radius: 12px;
    overflow: hidden;
    background: #f6f6f6; /* sehr helles Papiergrau */
    border: 0; /* kein dominanter Rahmen */
    height: min(85vh, 980px);
  }

  .pdf-object {
    width: 100%;
    height: 100%;
    border: 0;
    display: block;
    background: transparent;
  }

  .pdf-fallback {
    padding: 1rem;
    font-size: 0.95rem;
    line-height: 1.5;
    color: rgba(0, 0, 0, 0.65);
  }

  figcaption {
    margin-top: 0.75rem;
    font-size: 0.95rem;
    line-height: 1.45;
    color: rgba(0, 0, 0, 0.7);
  }

  /* ===== Hinweis unter dem PDF: einfach normaler Text ===== */
  .credit {
    margin-top: 0.9rem;
    padding: 0;
    font-size: inherit;
    line-height: inherit;
    color: inherit;
  }

  /* ===== Gedicht-Bereich ===== */
  section.poem-wrap {
  background: transparent;
  border: 0;
}
  .poem-wrap {
    margin-top: 2.2rem;
    padding-top: 1.6rem;
  }

  .poem-h2 {
    margin: 0 0 0.6rem 0;
    font-size: 1.35rem;
    letter-spacing: -0.01em;
  }

  .poem-transition {
    margin: 0 0 0.7rem 0;
    font-size: 1rem;
    line-height: 1.6;
    color: rgba(0, 0, 0, 0.78);
  }

.poem-figure,
.poem-click {
  background: transparent;
  border: 0;
  box-shadow: none;
}


  .poem-click:hover {
    border-color: rgba(0, 0, 0, 0.18);
  }

  .poem-click:focus-visible {
    outline: 2px solid rgba(0, 0, 0, 0.22);
    outline-offset: 2px;
  }

  .poem-img {
    display: block;
    width: 100%;
    height: auto;
    max-width: 550px;
  }

  .poem-cap {
    margin-top: 0.6rem;
    font-size: 0.95rem;
    color: rgba(0, 0, 0, 0.65);
  }

  .poem-hint {
    margin: 0.6rem 0 0 0;
    font-size: 0.95rem;
    line-height: 1.55;
    color: rgba(0, 0, 0, 0.62);
  }

  /* ===== Dialog ===== */
  .dialog {
    width: min(820px, calc(100vw - 28px));
    height: min(78vh, 560px); /* FIX: stabile Höhe, kein “Pulsieren” */
    border: 0;
    padding: 0;
    border-radius: 16px;
    box-shadow: 0 18px 60px rgba(0, 0, 0, 0.22);
    outline: none;
  }

  .dialog::backdrop {
    background: rgba(0, 0, 0, 0.42);
  }

  .dialog-inner {
    height: 100%;
    background: #fff;
    border-radius: 16px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

.dialog-head {
  display: flex;
  align-items: flex-start;
  justify-content: space-between; /* links Titel, rechts schließen */
  gap: 12px;
  padding: 16px 18px 10px 18px;
  border-bottom: 0;
}

/* falls dialog-kicker noch irgendwo existiert: komplett ausblenden */
.dialog-kicker {
  display: none;
}

.dialog-h {
  font-size: 1.55rem;          /* größer */
  font-weight: 750;
  letter-spacing: -0.01em;
}

  .dialog-close {
    all: unset;
    cursor: pointer;
    font-size: 0.95rem;
    color: rgba(0, 0, 0, 0.65);
    padding: 6px 10px;
    border-radius: 10px;
  }

  .dialog-close:hover {
    background: rgba(0, 0, 0, 0.04);
  }

  .dialog-close:focus-visible {
    outline: 2px solid rgba(0, 0, 0, 0.18);
    outline-offset: 2px;
  }

  .dialog-body {
    padding: 14px 18px;
    padding-top: ;
    overflow: auto; /* FIX: Inhalt scrollt, Höhe bleibt */
    flex: 1 1 auto;
  }

/* näher an den Titel */
.panel-meta {
  margin-top: 2px;     /* fast direkt unter dem Titel */
  margin-bottom: 18px; /* deutlich mehr Luft zu den Paaren */
  font-size: 0.95rem;
}


.lines {
  display: grid;
  gap: 20px; /* Abstand zwischen Paaren */
}

.pair {
  padding: 0;
  border: 0;
  background: transparent;
  border-radius: 0;
}


  .dialekt {
    font-size: 1rem;
    font-weight: 700;
    line-height: 1.45;
    color: rgba(0, 0, 0, 0.8);
    margin: 0 0 8px 0;
  }

  .deutung {
    font-size: 0.98rem;
    line-height: 1.45;
    color: rgba(0, 0, 0, 0.7);
  }

  .dialog-foot {
    padding: 12px 18px 16px 18px;/* rechts bündig wie Header */
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    color: rgba(0, 0, 0, 0.55);
  }

  .nav-link {
    all: unset;
    cursor: pointer;
    font-size: 0.98rem;
    color: rgba(0, 0, 0, 0.62);
    padding: 2px 6px;
    border-radius: 8px;
  }

  .nav-link:hover {
    background: rgba(0, 0, 0, 0.04);
  }

  .nav-link:focus-visible {
    outline: 2px solid rgba(0, 0, 0, 0.18);
    outline-offset: 2px;
  }

  .nav-link:disabled {
    cursor: not-allowed;
    opacity: 0.35;
  }

  .nav-sep {
    opacity: 0.5;
  }

  @media (max-width: 560px) {
    .dialog {
      height: min(82vh, 640px);
    }

    .dialog-head {
      padding: 14px 14px 10px 14px;
    }

    .dialog-body {
      padding: 12px 14px;
    }

    .dialog-foot {
      padding: 10px 14px 14px 14px;
    }
  }

#poem-dialog {
  width: 680px !important;
  max-width: calc(100vw - 32px) !important;

  height: 480px !important;
  max-height: calc(100vh - 32px) !important;
}
#poem-dialog .panel-meta {
  margin-top: -12px !important;   /* zieht den Abschnitt nach oben */
  margin-bottom: 28px !important;  /* Luft vor dem ersten Paar */
}

/* ===== HAMMER: Titelbereich enger + Abschnitt kontrolliert ===== */


#poem-dialog .dialog-head { background: rgba(255,0,255,0.10) !important; }
#poem-dialog .dialog-body { background: rgba(0,255,255,0.10) !important; }
#poem-dialog .panel-meta  { outline: 3px solid hotpink !important; }

/* ===== HAMMER: Header flacher ===== */

/* Header unten enger */
#poem-dialog .dialog-head{
  padding-bottom: 4px !important;  /* vorher war deutlich mehr */
}

/* Titelblock: keine versteckten Margins */
#poem-dialog .dialog-title{
  margin: 0 !important;
  padding: 0 !important;
}

/* Titel selbst: kompakter Zeilenabstand, keine Luft */
#poem-dialog .dialog-h{
  margin: 0 !important;
  line-height: 1.05 !important;
}

</style>
